## 양방향 연관관계와 연관관계의 주인   

< 양방향 연관관계 >   

![image](https://user-images.githubusercontent.com/46811084/144751647-4c4a8dde-dfc3-4d33-b736-fa52c27e1380.png)

1. 테이블의 양방향   
: 외래키 하나로 두 테이블의 연관관계를 관리한다. 양쪽 조인 가능

2. 객체의 양방향
: 객체의 양방향 연관관계는 사실 양방향 관계가 아니고 단방향 2개를 뜻한다. 객체를 양방향으로 참조하려면 단반향 연관관계를 2개 만들어야 한다.

----------------------------------------------------------------------------------------------------------------

< 연관관계의 주인 >   


![image](https://user-images.githubusercontent.com/46811084/144752474-5c4406ed-bda5-4f32-b306-4033bc7c6235.png)   

Member의 team 이 바뀌거나 team에 멤버들이 바뀔 때 Member와 Team중 어떤거로 외래키를 관리 해야 할지 모호하다.    
.   
.    
따라서 연관관계의 주인만이 외래키를 관리하도록 해야한다. 

### 양방향 매핑의 규칙
1. 연관관계 주인만이 외래키를 관리(등록, 수정)
2. **주인이 아닌 쪽은 읽기만 가능**
3. 주인은 mappedBy 속성 사용 X
4. 주인이 아니면 mappedBy 속성으로 주인을 지정해줘야한다.   

----------------------------------------------------------------------------------------------------------------
### 그러면 연관관계의 주인을 누구로 해야할까?   

![image](https://user-images.githubusercontent.com/46811084/144753584-5a4d3834-c462-4689-a1f7-739f131e7ad4.png)

- <<**외래키가 있는 곳을 주인**>> 으로 정하자.   
  -> 만약 외래키가 없는 곳을 주인으로 정한다면 다른 테이블에 쿼리가 나가 버리니까 헷갈릴 수 있다. 따라서 외래키가 있는 곳을 주인으로 정할것
- Many 쪽이 무조건 연관관계의 주인이 되도록 하자.

----------------------------------------------------------------------------------------------------------------

### 주의할점
- 양방향 매핑 시 주인에 값을 입력해야한다.
- **순수한 객체 관계를 고려하면 항상 양쪽 다 값을 입력해야 한다.**
   이 때, 연관관계 편의 메소드를 생성하자. 편의메소드의 이름은 setter말고 의미 있는 메소드 이름으로 설정하자!   
- 무한 루프 조심 ex) toString()

### 정리
- 단방향 매핑만으로 이미 연관관계 매핑은 완료된것
- 양방향 매핑은 반대 방향으로 **조회(객체 그래프 탐색)** 기능이 추가된 것 뿐
- 단방향 매핑을 잘 하고 양방향은 필요할 때 추가하면 된다.
- 즉 **테이블에 영향을 주지 않는다.**
